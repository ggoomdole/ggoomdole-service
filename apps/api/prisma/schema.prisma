generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model SearchKeyword {
  id        Int      @id @default(autoincrement())
  userId    Int
  word      String
  createAt  DateTime
  updateAt  DateTime

  user      User     @relation(fields: [userId], references: [id])
}

model Place {
  id        z
  name      String
  phone     String?
  address   String?
  latitude  Float?
  longitude Float?
  hours     String?
  avgRate   Int?

  reviews   Review[]
  pilgrimageSpots PilgrimageSpot[]
}

model Review {
  id        Int     @id @default(autoincrement())
  userId    Int
  placeId   Int
  text      String
  rate      Int?
  createAt  DateTime

  user      User     @relation(fields: [userId], references: [id])
  place     Place    @relation(fields: [placeId], references: [id])
}

model PilgrimageSpot {
  pilgrimageId Int
  spotId       Int
  number       Int
  introSpot    String
  request      Boolean
  createAt     DateTime
  updateAt     DateTime

  pilgrimage   Pilgrimage @relation(fields: [pilgrimageId], references: [id])
  place        Place      @relation(fields: [spotId], references: [id])

  @@id([pilgrimageId, spotId])
}

model PilgrimageUser {
  userId       Int
  pilgrimageId Int
  type         Boolean
  createAt     DateTime
  updateAt     DateTime

  user         User        @relation(fields: [userId], references: [id])
  pilgrimage   Pilgrimage  @relation(fields: [pilgrimageId], references: [id])

  @@id([userId, pilgrimageId])
}

model Pilgrimage {
  id         Int     @id @default(autoincrement())
  title      String @unique
  imageUrl   String?
  intro      String
  search     Int      @default(0)
  public     Boolean
  createAt   DateTime
  updateAt   DateTime

  categoryId  Int
  category    Category   @relation(fields: [categoryId], references: [id])

  spots      PilgrimageSpot[]
  participants PilgrimageUser[]
}

model User {
  id           Int            @id @default(autoincrement())
  kakaoId      String         @unique
  nickName     String         @unique
  profileImage String?
  native       Native?
  createAt     DateTime
  updateAt     DateTime

  searchKeywords SearchKeyword[]
  reviews        Review[]
  pilgrimages    PilgrimageUser[]
}

model Category {
  id         Int     @id @default(autoincrement())
  name       String

  pilgrimages Pilgrimage[]
}

enum Native {
  SHORT_TERM
  MID_TERM
  LONG_TERM
  RESIDENT
}